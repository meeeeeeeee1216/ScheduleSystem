<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>ショーシフト管理システム</title>
    </head>
    <body>
        
        <script src = "../public/js/make_header.js" type="text/javascript"></script>
        <main>
            <div class="title">
                <h2><%= show_name %> 新ポジション登録</h2>
                <ul>
                    <li><b>すでに公開されているシフト</b>に対してのみポジション登録を行うことができます</li>
                    <li>すでに登録されているポジションと同じ名前で登録することはできません。表記を分けて登録してください（〇〇１,〇〇２など）</li>
                    <li><b>新人や未登録のキャスト</b>が新ポジションを担当した場合は、
                        <a href=<%= "http://localhost:3000/entertainer/new-ent?redirect=/show-admin/create-position?show_id=" + show_id %>>
                            ここから</a>
                        登録を行ったのち、新ポジションの追加をおこなってください</li>
                </ul>
            </div>
            <form action=<%= "http://localhost:3000/show-admin/create-position"%> method="post">
                <div id="info">
                    <h3>＜ポジションが増えた　公演の日時＞</h3>
                    <select name="time" required>
                        <% tt.forEach(tt => { %>
                            <option value=<%= tt.tt_id %>><%=tt.day_and_time.toLocaleString() %></option>
                        <% }) %>
                    </select>
                </div>
                <div id="new-roll">
                    <h3>新ポジション登録</h3>
                    <p style="display:inline-block">ポジション名：</p>
                    <input type="text" name="position_name" id="position_name">
                    <br>
                    <p style="display:inline-block">ポジションが増えたときに担当したキャスト名：</p>
                    <select name="ent_name" id="all_cast">
                        <% all_cast.forEach(cast => { %>
                            <option value=<%=cast.entertainer_id %> > <%= cast.entertainer_name %> </option>
                        <% });%>
                    </select>
                </div>
                <input type="text" name="show_id" style="display: none;" value=<%= show_id %> >
                <button name="send" type="submit" onSubmit="return check_Unregistered">追加</button>
            </form>

            <script type="text/javascript">
                function check_Unregistered(){
                    const all_cast = document.getElementById("all_cast").options;
                    let input_name = document.getElementById("ent_name_text").value;
                    for(let cast of all_cast){
                        if(input_name == cast.label){
                            alart("入力されたキャスト名は既に使用されています");
                            return false
                        }
                    }
                    return ture
                };
            </script>
            
        </main>
   </body>
</html>