<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>ショーシフト管理システム</title>
    </head>
    <body>
        
        <script src = "../public/js/make_header.js" type="text/javascript"></script>
        <main>
            <div class="title">
                <h2><%= show_name %> 新ポジション登録</h2>
            </div>
            <form action=<%= "http://localhost:3000/show-admin/create-position?show_id=" + show_id %> method="post">
                <div id="info">
                    <h3>＜ポジションが増えた　公演の日時＞</h3>
                    <input type="datetime-local" name="time" require>
                </div>
                <div id="new-roll">
                    <h3>新ポジション登録</h3>
                    <p>すでに登録されているポジションと同じ名前で登録することはできません。表記を分けて登録してください（〇〇１,〇〇２など）</p>
                    <br>
                    <p style="display:inline-block">ポジション名：</p>
                    <input type="text" name="position_name" id="position_name">
                    <br>
                    <select name="ent_name" id="all_cast">
                        <option value="0" > 不明 </option>
                        <% all_cast.forEach(cast => { %>
                            <option value=<%=cast.entertainer_id %> > <%= cast.entertainer_name %> </option>
                        <% });%>
                    </select>
                    <br>
                    <p>新人キャストが担当した場合はこちらに入力</p>
                    <p>ほかのショーも含め同一名でのキャスト登録ができません。同姓同名キャストが複数存在する場合は表記を分けて登録してください。</p>
                    <p>同一名キャストの競合を避けるため、可能な限りSNSのアカウント名など正確な活動名で登録することを推奨します。</p>
                    <p>複数の呼称が存在するキャストについては（）などを用いてすべての表記を記載してください</p>
                    <p>名前が判明していない場合はショー名を入れるなど競合を避けるよう工夫してください。（例：パレード2025_新人Ａなど）</p>
                    <input type="text" name="ent_name_text" id="ent_name_text">
                </div>
                <button name="send" type="submit" onSubmit="return check_Unregistered">追加</button>
            </form>

            <script type="text/javascript">
                function check_Unregistered(){
                    const all_cast = document.getElementById("all_cast").options;
                    let input_name = document.getElementById("ent_name_text").value;
                    for(let cast of all_cast){
                        if(input_name == cast.label){
                            alart("入力されたキャスト名は既に使用されています");
                            return false
                        }
                    }
                    return ture
                };
            </script>
            
        </main>
   </body>
</html>